[include mainsail.cfg]
[virtual_sdcard]
path: /home/pi/printer_data/gcodes
on_error_gcode: CANCEL_PRINT

[mcu]
serial: /dev/serial/by-id/usb-Klipper_lpc1768_2450030FA498C89535E83461C42000F5-if00
# serial: /dev/ttyACM0

[printer]
kinematics: cartesian
max_velocity: 150
max_accel: 500
max_accel_to_decel: 500
square_corner_velocity: 5.0
max_z_velocity: 7
max_z_accel: 100

[stepper_x]
step_pin: P2.2
dir_pin: !P2.6
enable_pin: !P2.1
microsteps: 16
rotation_distance: 40
endstop_pin: P1.29
position_endstop: 0
position_max: 235
homing_speed: 25

[tmc2209 stepper_x]
uart_pin: P1.10
interpolate: True
run_current: 0.9
sense_resistor: 0.110
stealthchop_threshold: 0

[stepper_y]
step_pin: P0.19
dir_pin: !P0.20
enable_pin: !P2.8
microsteps: 16
rotation_distance: 40
endstop_pin: P1.28
position_endstop: 0
position_max: 235
homing_speed: 25

[tmc2209 stepper_y]
uart_pin: P1.9
interpolate: True
run_current: 0.9
sense_resistor: 0.110
stealthchop_threshold: 0

[stepper_z]
step_pin: P0.22
dir_pin: P2.11
enable_pin: !P0.21
microsteps: 16
rotation_distance: 8  # full_step_per_rotation (360 / 1.8 stepper moter = 200) * microstep (16) / steps_per_mm (400)
endstop_pin: probe:z_virtual_endstop
# with bl-touch, below two parameters are not required.
# endstop_pin: P1.27
# position_endstop: 0
position_min: -5
position_max: 250

[tmc2209 stepper_z]
uart_pin: P1.8
interpolate: True
run_current: 0.7
sense_resistor: 0.110
stealthchop_threshold: 0

[bltouch]
sensor_pin: ^P0.10
control_pin: P2.0
# x_offset: -41.50
# y_offset: -4.0
x_offset: -43.0
y_offset: -2.0
#z_offset: 2.265

[safe_z_home]
home_xy_position: 110, 118
speed: 50
z_hop: 10
z_hop_speed: 5

[bed_mesh]
speed: 60
horizontal_move_z: 5
mesh_min: 30, 30
mesh_max: 192, 200
probe_count: 5, 5
algorithm: bicubic
fade_start: 1
fade_end: 10
fade_target: 0

[extruder]
max_extrude_only_distance: 101
step_pin: P2.13
dir_pin: !P0.11
enable_pin: !P2.12
microsteps: 16
rotation_distance: 7.721616
nozzle_diameter: 0.400
filament_diameter: 1.750
heater_pin: P2.7
sensor_type: Generic 3950  # from aliexpress: 13:100k Hisens 3950 1% up to 300Â°C for hotend 'Simple ONE' & 'Hotend' 'All In ONE'
sensor_pin: P0.24
control: pid
# Overture PLA
# TODO: for v6 hotend yet to calibrate
#
# Polymaker PETG
# tunned with skr 1.4 and nf-volcano from mellow-3d
# below is 3rd result and seems good
# PID parameters: pid_Kp=26.633 pid_Ki=1.192 pid_Kd=148.813
pid_Kp: 26.633
pid_Ki: 1.192
pid_Kd: 148.813
min_temp: 0
max_temp: 260

[tmc2209 extruder]
uart_pin: P1.4
interpolate: True
run_current: 0.5
sense_resistor: 0.110
stealthchop_threshold: 0

[heater_bed]
heater_pin: P2.5
sensor_type: EPCOS 100K B57560G104F  # still using the stock sensor so no change
sensor_pin: P0.25
control: pid
# Overture PLA
# TODO: yet to calibrate
#
# Polymaker PETG
# tunned for skr 1.4 for 70 C
# PID parameters: pid_Kp=68.335 pid_Ki=1.248 pid_Kd=935.337
pid_Kp: 68.335
pid_Ki: 1.248
pid_Kd: 935.337
min_temp: 0
max_temp: 110

# screw location obtained from stck firmware.
[bed_screws]
screw1: 50, 50
screw1_name: left_front
screw2: 185, 50
screw2_name: right_front
screw3: 185, 185
screw3_name: right_rear
screw4: 50, 185
screw4_name: left_rear
screw5: 115, 115
screw5_name: center

# Part cooling fan
[fan]
pin: P2.3

# Hotend fan
[heater_fan hotend_fan]
pin: P2.4  # pin is for HotEnd 1, I am using HotEnd 0 only.
heater: extruder
heater_temp: 50.0

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [bltouch]
#*# z_offset = 2.300
